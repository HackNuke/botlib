#!/usr/bin/env python3
#
#

import ok.obj, os, sys ; sys.path.insert(0, os.getcwd())

from ok.shl import execute
from okbot.xmpp import XMPP

opts = [
    ('-u', "--user", 'store', str, "user", "set username to login with (JID)"),
    ('-l', '--loglevel', 'store', str, "error", 'set loglevel.', 'level'),
    ('-m', '--modules', 'store', str, "", 'modules to load.', 'modules'),
    ('-n', '--nick', 'store', str, "", 'nickname to use.', 'nick'),
    ('-o', '--options', 'store', str, "", "options to use", 'options'),
    ('-r', '--room', 'store', str, "", "room to join", 'room'),
    ('-s', '--server', 'store', str, "", "server to connect to", 'server'),
    ('-w', '--workdir', 'store', str, "", "directory to work on", 'workdir'),
]

def main():
    parse_cli("okbot", opts)
    
    ok.obj.workdir = os.path.expanduser("~/.okbot")
    xmpp = XMPP()
    xmpp.walk("bot")
    xmpp.start()
    xmpp.wait()

execute(main)
