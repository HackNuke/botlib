#!/usr/bin/env python3
# This file is placed in the Public Domain.


"bot command"


import inspect
import os
import readline
import sys
import termios
import time
import traceback


sys.path.insert(0, os.getcwd())


from ot.cfg import Cfg
from ot.cls import Cls
from ot.cmd import Cmd
from ot.dft import Default
from ot.evt import Event
from ot.fnc import format
from ot.krn import boot, kcmd
from ot.obj import Object, update, values
from ot.prs import parse, parse_cli
from ot.hdl import Handler
from ot.tbl import Tbl
from ot.tms import tfmt
from ot.thr import launch


import ot.all
import bot.all



Cfg.wd = os.path.expanduser("~/.bot")


class CLI(Handler):


    def raw(self, txt):
        print(txt)


def scan():
    for mod in values(Tbl.mod):
        for k, o in inspect.getmembers(mod, inspect.isfunction):
            if "event" in o.__code__.co_varnames:
                Cmd.cmds[k] = o
        for k, clz in inspect.getmembers(mod, inspect.isclass):
            Cls.add(clz)
        Tbl.add(mod)


def main():
    scan()
    cfg = boot(" ".join(sys.argv[1:]))
    c = CLI()
    return kcmd(c, cfg.otxt)

main()
