#!/usr/bin/env python3
# This file is placed in the Public Domain.


"reverse bot command"


import inspect
import os
import readline
import sys
import termios
import time
import traceback


sys.path.insert(0, os.getcwd())


from ob.cfg import Cfg
from ob.cls import Cls
from ob.cmd import Cmd
from ob.dft import Default
from ob.evt import Event
from ob.fnc import format
from ob.krn import boot, kcmd
from ob.obj import Object, update, values
from ob.prs import parse, parse_cli
from ob.hdl import Handler
from ob.tbl import Tbl
from ob.tms import tfmt
from ob.thr import launch


import ob.all
import mod.all



Cfg.wd = os.path.expanduser("~/.ob")


class CLI(Handler):


    def raw(self, txt):
        print(txt)


def scan():
    for mod in values(Tbl.mod):
        for k, o in inspect.getmembers(mod, inspect.isfunction):
            if "event" in o.__code__.co_varnames:
                Cmd.cmds[k] = o
        for k, clz in inspect.getmembers(mod, inspect.isclass):
            Cls.add(clz)
        Tbl.add(mod)


def main():
    scan()
    cfg = boot(" ".join(sys.argv[1:]))
    c = CLI()
    return kcmd(c, cfg.otxt)

main()
