#!/usr/bin/python3
#
# run unittests.

__version__ = 1

import os,sys ; sys.path.insert(0, os.getcwd())

import logging, os, shutil, time, unittest

from bot.spc import cdir, get_kernel, execute, elapsed, parse_cli, starttime

resume = {}

def main():
    parse_cli("test", wd=".data", debug=True)
    try:
        shutil.rmtree(".data")
    except FileNotFoundError:
        pass
    k = get_kernel()
    k.start()
    k.walk("bot")
    test_path = os.getcwd() + os.sep + "tests"
    suite = unittest.loader.TestLoader().discover(test_path, pattern="test*")
    unittest.TextTestRunner(verbosity=3).run(suite)
    k.wait()
   
execute(main)
print(elapsed(time.time() - starttime))
os._exit(0)
