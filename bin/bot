#!/usr/bin/env python3
# This file is placed in the Public Domain.

import os, sys ; sys.path.insert(0, os.getcwd())

from bot.bus import Bus
from bot.evt import Command
from bot.irc import Cfg
from bot.hdl import Client, cmd
from bot.obj import cfg
from bot.nms import Names
from bot.trc import exception
from bot.trm import exec
from bot.zzz import os, sys, time

__version__ = 118

class Console(Client):

    prompt = True

    def handle(self, e):
        super().handle(e)
        e.wait()

    def poll(self):
        if Console.prompt:
            return input("> ")

    def raw(self, txt):
        sys.stdout.write(txt)
        sys.stdout.write("\n")
        sys.stdout.flush()

def ver(event):
    event.reply("BOT %s" % __version__)

def main():
    c = Console()
    c.add("ver", ver)
    if len(sys.argv) > 1:
        Console.prompt = False
        e = c.event(" ".join(sys.argv[1:]))
        cmd(c, e)
        e.wait()
        return
    c.boot()
    if cfg.mods:
        c.start()
        c.init(cfg.mods)
        c.wait()

exec(main)
