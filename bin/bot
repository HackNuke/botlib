#!/usr/bin/env python3
# This file is placed in the Public Domain.

import os
import sys 

sys.path.insert(0, "bot")

from csl import CLI
from hdl import Client, docmd, __version__
from krn import Kernel
from obj import cfg, opts
from trm import exec

mods = "adm,fnd,log,tdo,irc,rss,slg,udp"

def main():
    cfg.wd = "/var/lib/bot/"
    cfg.name = "bot"
    cfg.version = __version__
    k = Kernel()
    k.boot()
    cfg.mods = cfg.mods or mods
    if cfg.txt:
        c = CLI()
        return c.cmd(cfg.txt)
    if opts("w"):
        k.inits(mods)
        c = Client()
        c.start()
        c.wait()

exec(main)
