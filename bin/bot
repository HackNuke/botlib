#!/usr/bin/python3 -u
# BOTLIB - the bot library !
#
#

__version__ = 86

import os, sys ; sys.path.insert(0, os.getcwd())

from bot.csl import Console
from bot.irc import IRC
from bot.krn import k
from bot.shl import execute, parse_cli

import sys

def main():
    parse_cli()
    k.walk("botd")
    if not k.cfg.txt:
        print("""bot <%s>""" % "|".join(sorted(k.cmds)))
        return
    k.start()
    if "d" in k.cfg.opts:
        daemon()
    if "i" in k.cfg.opts:
        i = IRC()
        i.start()
    if "r" in k.cfg.opts:
        f = Fetcher()
        f.start()
    if "s" in k.cfg.opts:
        c = Console()
        c.start()
    if "w" in k.cfg.opts:
        k.wait()
    else:
        return k.cmd(k.cfg.txt)

execute(main)
