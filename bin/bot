#!/usr/bin/env python3
# This file is placed in the Public Domain.

import os, sys ; sys.path.insert(0, os.getcwd())

from bot.hdl import Client, cmd
from bot.nms import Names
from bot.obj import cfg
from bot.irc import Cfg
from bot.trm import exec
from bot.zzz import os, sys
from bot.tbl import tbl

__version__ = 118

Cfg.channel = "#botlib"
Cfg.nick = "botlib"

class Console(Client):

    prompt = True

    def handle(self, e):
        super().handle(e)
        e.wait()

    def poll(self):
        if Console.prompt:
            return input("> ")

    def raw(self, txt):
        sys.stdout.write(txt)
        sys.stdout.write("\n")
        sys.stdout.flush()

def ver(event):
    event.reply("BOTLIB %s" % __version__)

def main():
    Names.tbl(tbl)
    cfg.name = "bot"
    cfg.version = __version__
    c = Console()
    c.boot()
    c.add("ver", ver)
    if cfg.txt:
        c.prompt = False
        e = c.event(cfg.otxt)
        cmd(c, e)
        e.wait()
        return
    if cfg.mods:
        c.start()
        c.init(cfg.mods)
        c.wait()

exec(main)
