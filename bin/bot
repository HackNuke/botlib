#!/usr/bin/env python3
# This file is placed in the Public Domain.

import os
import sys 

from bot.hdl import Client, docmd, __version__
from bot.krn import Kernel
from bot.obj import cfg, opts
from bot.trm import exec

all = "adm,fnd,log,tdo,irc,rss,slg,udp"
min = "adm,irc"

class CLI(Client):

    def handle(self, e):
        super().handle(e)
        e.wait()

    def raw(self, txt):
        print(txt)

class Console(CLI):

    def poll(self):
        return input("> ")

def main():
    k = Kernel()
    k.boot("bot", __version__, os.path.expanduser("~/.bot"))
    cfg.mods = cfg.mods + min
    k.regs(cfg.mods)
    if cfg.txt:
        c = CLI()
        return c.cmd(cfg.txt)
    c = Console()
    if cfg.mods:     
        k.inits(cfg.mods)
        c.start()
        c.wait()

exec(main)
